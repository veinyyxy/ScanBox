<HTML>
<HEAD>
<META NAME="GENERATOR" Content="Microsoft Visual Studio">
<TITLE></TITLE>
</HEAD>
<BODY>
	<script type="text/javascript">
		function NextImage(){
			var fileName = sc.nextImage();
			var imageBox = document.getElementsByName("showImage")[0];
			newName = "file://" + fileName;
			//alert(newName);
			imageBox.src = newName;
			
		}

		function PreImage(){
			var fileName = sc.perviousImage();
			var imageBox = document.getElementsByName("showImage")[0];
			newName = "file://" + fileName;
			//alert(newName);
			imageBox.src = newName;
			
		}

		function GetIndex(){
			var Index = sc.getFileIndex();
			alert(Index);
		}

		function GetFileIndex(){
			var filePath = document.getElementsByName("filePath")[0].value;
			var fileCount = sc.getFileIndex(filePath);
			alert(fileCount);
		}
		
		function SetScanFolder(){
			var filePath = document.getElementsByName("scanFolder")[0].value;
			var fileCount = sc.setScanFolder(filePath);
			alert(fileCount);
		}
		function GetFileLIst(){
			
			var fileList = sc.getFileList();
			alert(fileList);
		}
		function test()
		{
			sc.setCurrentIndex(0);
			sc.mosaicImage(0, 0, 0, 300, 300, 0.2);

			sc.setCurrentIndex(1);
			sc.mosaicImage(1, 0, 0, 600, 600, 0.6);

			sc.setCurrentIndex(2);
			sc.mosaicImage(2, 600,600, 300, 300, 0.2);

			sc.setCurrentIndex(7);
			sc.mosaicImage(7, 600, 600, 600, 600, 0.6);

			sc.setCurrentIndex(8);
			sc.mosaicImage(8, 750, 750, 600, 600, 0.1);

			sc.setCurrentIndex(9);
			sc.mosaicImage(9, 800, 800, 600, 600, 0.01);
		}
	</script>

	<script language="javascript" type="text/javascript" event="sc::ColorValue(argb)" for="sc">
		alert(argb);
		function ColorValue(argb)
		{
			alert(argb);
		}
	</script>

	<table>
		<tr>
			<td>
				文件夹:
			</td>
			<td>
				<input type="text" style="width:300px" value="D:\\temp\\ScanBox"></input>
			</td>
			<td><input type="button" value="newScan" onclick="sc.newScan('D:\\temp\\ScanBox');"></input></td>
			<td><input type="button" value="testFun" onclick="test();"></input></td>
		</tr>
		<tr>
			<td><input type="button" value="perviousImage" onclick="PreImage();"></input></td>
			<td><input type="button" value="nextImage" onclick="NextImage();"></input></td>
			<td><input type="button" value="SaveConfig" onclick="sc.SaveConfig();"></input></td>
			<td><input type="button" value="LoadConfig" onclick="sc.LoadConfig();"></input></td>
			<td><input type="button" value="clearScan" onclick="sc.clearScan();"></input></td>
			<td><input type="button" value="deleteImage" onclick="sc.deleteImage(sc.getCurrentIndex(), 1);sc.SaveConifg();"></input></td>
			<td><input type="button" value="uploadFile" onclick="sc.uploadFile('test.zip');"></input></td>
			<td><input type="button" value="getFileIndex" onclick="GetIndex()"></input></td>
			<td><input type="button" value="adjustFile" onclick="sc.adjustFile(0, 2);"></input></td>
			<td><input type="button" value="getCurrentIndex" onclick="sc.getCurrentIndex();"></input></td>
			<td><input type="button" value="getFileCount" onclick="sc.getFileCount();"></input></td>
			<td><input type="button" value="getFileInfo" onclick="alert(sc.getFileInfo(6));"></input></td>
		</tr>
		<tr>
			<td>扫描到：</td>
			<td><input type="text" name="scanFolder" style="width:300px" value="D:\\temp\\ScanBox"></input></td>
			<td><input type="button" value="setScanFolder" onclick="SetScanFolder();"></input></td>
		</tr>
		<tr>
			<td>文件路径：</td>
			<td><input type="text" name="filePath" style="width:300px"></input></td>
			<td><input type="button" value="getFileIndex" onclick="GetFileIndex()"></input></td>
		</tr>
		<tr>
			
		</tr>
		<tr>
			<td><input type="button" value="replaceScan" onclick="alert(sc.replaceScan());"></input></td>
			<td><input type="button" value="insertScan" onclick="alert(sc.insertScan(true));"></input></td>
			<td><input type="button" value="getFileList" onclick="GetFileLIst();"></input></td>
			<td><input type="button" value="setCurrentIndex" onclick="sc.setCurrentIndex(3);"></input></td>
			<td><input type="button" value="insertExternalFile" onclick="sc.insertExternalFile('D:\\temp\\del\\3.jpg', true, false);"></input></td>
			<td><input type="button" value="getDiskFile" onclick="alert(sc.getDiskFile('打开文件', 'D:\\temp\\', 'Images (*.png *.bmp *.jpg)'));"></input></td>
			<td><input type="button" value="getFileInfo" onclick="alert(sc.getFileInfo(0));alert(sc.getRemoveInvokeError());"></input></td>
			<td><input type="button" value="writeTextToImage" onclick="alert(sc.writeTextToImage(0, 800, 800, 4278255360, 20, 30, true, true, true,'微软雅黑', '我们是人类'));"></input></td>
			<td><input type="button" value="DrawImageToImage" onclick="alert(sc.DrawImageToImage(0, 500, 500, false, 30, 1, 'D:\\temp\\del\\watermark.bmp'));"></input></td>
			<td><input type="button" value="getColor" onclick="alert(sc.getColor());"></input></td>
			<td><input type="button" value="getFont" onclick="alert(sc.getFont());"></input></td>
			<td><input type="button" value="rotateImage" onclick="alert(sc.rotateImage(0, 30));"></input></td>
			<td><input type="button" value="sharpenImage" onclick="alert(sc.sharpenImage(0));"></input></td>
		</tr>
		<tr>
			<td><input type="button" value="clipImage" onclick="alert(sc.clipImage(0, 200, 200, 500, 500));"></input></td>
			<td><input type="button" value="mosaicImage" onclick="alert(sc.mosaicImage(0, 150, 150, 250, 250, 0.25));"></input></td>
			<td><input type="button" value="getDeviceList" onclick="alert(sc.getDeviceList());"></input></td>
			<td><input type="button" value="setDefaultDevice" onclick="alert(sc.setDefaultDevice('TWAIN2 Software Scanner'));"></input></td>
			<td><input type="button" value="rectifyImage" onclick="alert(sc.rectifyImage(5, 170));"></input></td>
			<td><input type="button" value="getDefaultDevice" onclick="alert(sc.getDefaultDevice());"></input></td>
			<td><input type="button" value="replaceCurrentFile" onclick="alert(sc.replaceCurrentFile('D:\\temp\\del\\3.jpg'));"></input></td>
			<td><input type="button" value="setConnectTimeout" onclick="sc.setConnectTimeout(-1)"></input></td>
			<td><input type="button" value="setWriteTimeout" onclick="sc.setWriteTimeout(-1)"></input></td>
			<td><input type="button" value="setReadTimeout" onclick="sc.setReadTimeout(-1)"></input></td>
			<td><input type="button" value="getRemoveInvokeError" onclick="sc.getRemoveInvokeError()"></input></td>
		</tr>
		<tr>
			<td><input type="text" style="width:60px"></td><td><input type="button" value="getFileFullName" onclick="alert(sc.getFileFullName(130));"></input></td>
			<td><input type="button" value="GenerateMicrograph" onclick="sc.GenerateMicrograph('D:\\temp\\ScanBox\\{fc333a3c-7e00-4d4d-8d5d-6675367d3266}.jpg', 0.2)"></input></td>
			<td><input type="button" value="insertExternalFiles" onclick="sc.insertExternalFiles('D:\\temp\\del\\1.jpg|D:\\temp\\del\\2.jpg|D:\\temp\\del\\3.jpg', true, false);"></input></td>
			<td><input type="button" value="getFileInfoFromNames" onclick="sc.getFileInfoFromNames('D:\\temp\\del\\1.jpg');"></input></td>
			<td><input type="button" value="ShowColorDialog" onclick="sc.ShowColorDialog(4278190080);"></input></td>
			<td><input type="button" value="uploadAnyFile" onclick="alert(sc.uploadAnyFile('http://192.168.1.111:8080/knowing-example-war/resoftCtrl/UploadController', 'D:\\temp\\test.docx'));"></input></td>
			<td><input type="button" value="ScalaImage" onclick="alert(sc.ScalaImage('C:\\Users\\fox-server\\Pictures\\The-letter-the-alphabet-22187607-2560-2560.jpg', 0.3));"></input></td>
			<td><input type="button" value="enableLoggingOutput" onclick="sc.enableLoggingOutput(true)"></input></td>
		</tr>
	</table>

	<object ID="sc" CLASSID="CLSID:A65A691D-D673-41B1-BA19-62123E7C4D72"></object>
  <img name="showImage" src="" width = "800" height = "800"></img>
</BODY>
</HTML>
